#!/usr/bin/env python3

from collections import OrderedDict
from typing import Dict, AbstractSet, MutableMapping

# ========================================= What can be exported? =========================================
__all__ = ['TYPED_NAMELISTS', 'NAMELISTS_NAMES']

TYPED_NAMELISTS: Dict[str, MutableMapping[str, str]] = {'CONTROL': OrderedDict([('calculation', 'str'),
                                                                                ('title', 'str'),
                                                                                ('verbosity', 'str'),
                                                                                ('restart_mode', 'str'),
                                                                                ('wf_collect', 'bool'),
                                                                                ('nstep', 'int'),
                                                                                ('iprint', 'int'),
                                                                                ('tstress', 'bool'),
                                                                                ('tprnfor', 'bool'),
                                                                                ('dt', 'float'),
                                                                                ('outdir', 'str'),
                                                                                ('wfcdir', 'str'),
                                                                                ('prefix', 'str'),
                                                                                ('lkpoint_dir', 'bool'),
                                                                                ('max_seconds', 'float'),
                                                                                ('etot_conv_thr', 'float'),
                                                                                ('forc_conv_thr', 'float'),
                                                                                ('disk_io', 'str'),
                                                                                ('pseudo_dir', 'str'),
                                                                                ('tefield', 'bool'),
                                                                                ('dipfield', 'bool'),
                                                                                ('lelfield', 'bool'),
                                                                                ('nberrycyc', 'int'),
                                                                                ('lorbm', 'bool'),
                                                                                ('lberry', 'bool'),
                                                                                ('gdir', 'int'),
                                                                                ('nppstr', 'int'),
                                                                                ('lfcpopt', 'bool'),
                                                                                ('gate', 'bool')]),
                                                        'SYSTEM': OrderedDict([('ibrav', 'int'),
                                                                               ('celldm', 'float'),
                                                                               ('A', 'float'),
                                                                               ('B', 'float'),
                                                                               ('C', 'float'),
                                                                               ('cosAB', 'float'),
                                                                               ('cosAC', 'float'),
                                                                               ('cosBC', 'float'),
                                                                               ('nat', 'int'),
                                                                               ('ntyp', 'int'),
                                                                               ('nbnd', 'int'),
                                                                               ('tot_charge', 'float'),
                                                                               ('starting_charge', 'float'),
                                                                               ('tot_magnetization', 'float'),
                                                                               ('starting_magnetization', 'float'),
                                                                               ('ecutwfc', 'float'),
                                                                               ('ecutrho', 'float'),
                                                                               ('ecutfock', 'float'),
                                                                               ('nr1', 'int'),
                                                                               ('nr2', 'int'),
                                                                               ('nr3', 'int'),
                                                                               ('nr1s', 'int'),
                                                                               ('nr2s', 'int'),
                                                                               ('nr3s', 'int'),
                                                                               ('nosym', 'bool'),
                                                                               ('nosym_evc', 'bool'),
                                                                               ('noinv', 'bool'),
                                                                               ('no_t_rev', 'bool'),
                                                                               ('force_symmorphic', 'bool'),
                                                                               ('use_all_frac', 'bool'),
                                                                               ('occupations', 'str'),
                                                                               ('one_atom_occupations', 'bool'),
                                                                               ('starting_spin_angle', 'bool'),
                                                                               ('degauss', 'float'),
                                                                               ('smearing', 'str'),
                                                                               ('nspin', 'int'),
                                                                               ('noncolin', 'bool'),
                                                                               ('ecfixed', 'float'),
                                                                               ('qcutz', 'float'),
                                                                               ('q2sigma', 'float'),
                                                                               ('input_dft', 'str'),
                                                                               ('exx_fraction', 'float'),
                                                                               ('screening_parameter', 'float'),
                                                                               ('exxdiv_treatment', 'str'),
                                                                               ('x_gamma_extrapolation', 'bool'),
                                                                               ('ecutvcut', 'float'),
                                                                               ('nqx1', 'int'),
                                                                               ('nqx2', 'int'),
                                                                               ('nqx3', 'int'),
                                                                               ('lda_plus_u', 'bool'),
                                                                               ('lda_plus_u_kind', 'int'),
                                                                               ('Hubbard_U', 'float'),
                                                                               ('Hubbard_J0', 'float'),
                                                                               ('Hubbard_alpha', 'float'),
                                                                               ('Hubbard_beta', 'float'),
                                                                               ('Hubbard_J', 'float'),
                                                                               ('starting_ns_eigenvalue', 'float'),
                                                                               ('U_projection_type', 'str'),
                                                                               ('edir', 'int'),
                                                                               ('emaxpos', 'float'),
                                                                               ('eopreg', 'float'),
                                                                               ('eamp', 'float'),
                                                                               ('angle1', 'float'),
                                                                               ('angle2', 'float'),
                                                                               ('constrained_magnetization', 'str'),
                                                                               ('fixed_magnetization', 'float'),
                                                                               ('lambda', 'float'),
                                                                               ('report', 'int'),
                                                                               ('lspinorb', 'bool'),
                                                                               ('assume_isolated', 'str'),
                                                                               ('esm_bc', 'str'),
                                                                               ('esm_w', 'float'),
                                                                               ('esm_efield', 'float'),
                                                                               ('esm_nfit', 'int'),
                                                                               ('fcp_mu', 'float'),
                                                                               ('vdw_corr', 'str'),
                                                                               ('london', 'bool'),
                                                                               ('london_s6', 'float'),
                                                                               ('london_c6', 'float'),
                                                                               ('london_rvdw', 'float'),
                                                                               ('london_rcut', 'int'),
                                                                               ('ts_vdw_econv_thr', 'float'),
                                                                               ('ts_vdw_isolated', 'bool'),
                                                                               ('xdm', 'bool'),
                                                                               ('xdm_a1', 'float'),
                                                                               ('xdm_a2', 'float'),
                                                                               ('space_group', 'int'),
                                                                               ('uniqueb', 'bool'),
                                                                               ('origin_choice', 'int'),
                                                                               ('rhombohedral', 'bool'),
                                                                               ('zgate', 'float'),
                                                                               ('relaxz', 'bool'),
                                                                               ('block', 'bool'),
                                                                               ('block_1', 'float'),
                                                                               ('block_2', 'float'),
                                                                               ('block_height', 'float')]),
                                                        'ELECTRONS': OrderedDict([('electron_maxstep', 'int'),
                                                                                  ('scf_must_converge', 'bool'),
                                                                                  ('conv_thr', 'float'),
                                                                                  ('adaptive_thr', 'bool'),
                                                                                  ('conv_thr_init', 'float'),
                                                                                  ('conv_thr_multi', 'float'),
                                                                                  ('mixing_mode', 'str'),
                                                                                  ('mixing_beta', 'float'),
                                                                                  ('mixing_ndim', 'int'),
                                                                                  ('mixing_fixed_ns', 'int'),
                                                                                  ('diagonalization', 'str'),
                                                                                  ('ortho_para', 'int'),
                                                                                  ('diago_thr_init', 'float'),
                                                                                  ('diago_cg_maxiter', 'int'),
                                                                                  ('diago_david_ndim', 'int'),
                                                                                  ('diago_full_acc', 'bool'),
                                                                                  ('efield', 'float'),
                                                                                  ('efield_cart', 'tuple'),
                                                                                  ('efield_phase', 'str'),
                                                                                  ('startingpot', 'str'),
                                                                                  ('startingwfc', 'str'),
                                                                                  ('tqr', 'bool')]),
                                                        'IONS': OrderedDict([('ion_dynamics', 'str'),
                                                                             ('ion_positions', 'str'),
                                                                             ('pot_extrapolation', 'str'),
                                                                             ('wfc_extrapolation', 'str'),
                                                                             ('remove_rigid_rot', 'bool'),
                                                                             ('ion_temperature', 'str'),
                                                                             ('tempw', 'float'),
                                                                             ('tolp', 'float'),
                                                                             ('delta_t', 'float'),
                                                                             ('nraise', 'int'),
                                                                             ('refold_pos', 'bool'),
                                                                             ('upscale', 'float'),
                                                                             ('bfgs_ndim', 'int'),
                                                                             ('trust_radius_max', 'float'),
                                                                             ('trust_radius_min', 'float'),
                                                                             ('trust_radius_ini', 'float'),
                                                                             ('w_1', 'float'),
                                                                             ('w_2', 'float')]),
                                                        'CELL': OrderedDict([('cell_dynamics', 'str'),
                                                                             ('press', 'float'),
                                                                             ('wmass', 'float'),
                                                                             ('cell_factor', 'float'),
                                                                             ('press_conv_thr', 'float'),
                                                                             ('cell_dofree', 'str')]),
                                                        'INPUTPH': OrderedDict([('amass', 'int'),
                                                                                ('outdir', 'str'),
                                                                                ('prefix', 'str'),
                                                                                ('niter_ph', 'int'),
                                                                                ('tr2_ph', 'float'),
                                                                                ('alpha_mix', 'float'),
                                                                                ('nmix_ph', 'int'),
                                                                                ('verbosity', 'str'),
                                                                                ('reduce_io', 'bool'),
                                                                                ('max_seconds', 'float'),
                                                                                ('fildyn', 'str'),
                                                                                ('fildrho', 'str'),
                                                                                ('fildvscf', 'str'),
                                                                                ('epsil', 'bool'),
                                                                                ('lrpa', 'bool'),
                                                                                ('lnoloc', 'bool'),
                                                                                ('trans', 'bool'),
                                                                                ('lraman', 'bool'),
                                                                                ('eth_rps', 'float'),
                                                                                ('eth_ns', 'float'),
                                                                                ('dek', 'float'),
                                                                                ('recover', 'bool'),
                                                                                ('low_directory_check', 'bool'),
                                                                                ('only_init', 'bool'),
                                                                                ('qplot', 'bool'),
                                                                                ('q2d', 'bool'),
                                                                                ('q_in_band_form', 'bool'),
                                                                                ('electron_phonon', 'str'),
                                                                                ('lshift_q', 'bool'),
                                                                                ('zeu', 'bool'),
                                                                                ('zue', 'bool'),
                                                                                ('elop', 'bool'),
                                                                                ('fpol', 'bool'),
                                                                                ('ldisp', 'bool'),
                                                                                ('nogg', 'bool'),
                                                                                ('asr', 'bool'),
                                                                                ('ldiag', 'bool'),
                                                                                ('lqdir', 'bool'),
                                                                                ('search_sym', 'bool'),
                                                                                ('nq1', 'int'),
                                                                                ('nq2', 'int'),
                                                                                ('nq3', 'int'),
                                                                                ('nk1', 'int'),
                                                                                ('nk2', 'int'),
                                                                                ('nk3', 'int'),
                                                                                ('k1', 'int'),
                                                                                ('k2', 'int'),
                                                                                ('k3', 'int'),
                                                                                ('start_irr', 'int'),
                                                                                ('last_irr', 'int'),
                                                                                ('nat_todo', 'int'),
                                                                                ('modenum', 'int'),
                                                                                ('start_q', 'int'),
                                                                                ('last_q', 'int'),
                                                                                ('dvscf_star', 'str'),
                                                                                ('drho_star', 'str')])}

NAMELISTS_NAMES: Dict[str, AbstractSet[str]] = {k: set(v.keys()) for k, v in TYPED_NAMELISTS.items()}
